<apex:page controller="AccountSummaryReportController"  action="{!loadKeyAccounts}" renderAs="pdf" >
    <apex:sectionHeader title="Property Enquiries by Country & Property Report as of : {!TODAY()}"  description="This Report Shows Accounts modified in last 31 days"/>
    <apex:form >
        <apex:pageBlock >
            <apex:repeat value="{!objectMap }" var="ProgNameKey">
            
            <p style="page-break-after:always;" ></p>
                <apex:pageBlock title="{!ProgNameKey}" >
                    <apex:repeat value="{!objectMap [ProgNameKey]}" var="PlanNameKey"> 
                        
                            <apex:pageBlockSection title="{!PlanNameKey}" columns="1" >
                                <apex:pageBlockTable value="{!objectMap [ProgNameKey][PlanNameKey]}" var="lstGrnRate"  border="1" columnsWidth="20%,5%,65%,10%" >
                                    <apex:column value="{!lstGrnRate.Account__r.Name}" headerValue="Customer" />
                                    <apex:column footerClass="reviewStatusHeader" HeaderValue="Status" headerClass="centHeader">
                                       <apex:image value="{! If(lstGrnRate.Status__c=="Red" ,URLFOR($Resource.RedFlag),
                                                      If(lstGrnRate.Status__c=="Green",URLFOR($Resource.GreenFlag), URLFOR($Resource.AmberFlag))) }" width="40" height="30" style="float:centre;"/>
                                     </apex:column>
                                    <apex:column value="{!lstGrnRate.Account_Summary__c}"/>
                                    <apex:column headerValue="Date of Update" value="{!lstGrnRate.lastModifiedDate}" /> 
                                </apex:pageBlockTable>
                            </apex:pageBlocksection>
                        
                    </apex:repeat>
                </apex:pageBlock>
                   
            </apex:repeat>
        </apex:pageBlock>
    </apex:form>
</apex:page>