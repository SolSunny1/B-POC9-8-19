<apex:page controller="AccountSummaryReportController" action="{!loadKeyAccounts}">


    
        <style>
            
             body .bPageBlock .pbBody .grey .pbSubheader{
                background-color:#c0c0c0;
            }
            body .bPageBlock .pbBody .grey .pbSubheader h3{
                color:#000;
           
                }
        </style>
    <apex:sectionHeader title="Property Enquiries by Region & Property Report as of : {!TODAY()}"  description="This report shows Property Enquiries modified in the last 31 days"/>
    <apex:form >
        <apex:pageBlock >
            <apex:pageBlockButtons >
                <apex:commandButton action="{!renderAsPdf}" value="Save as Pdf"/>
            </apex:pageBlockButtons>
            <apex:repeat value="{!objectMap }" var="ProgNameKey" >
                <apex:pageBlock title="{!ProgNameKey}" id="c">
                    <apex:repeat value="{!objectMap [ProgNameKey]}" var="PlanNameKey" >
                        <apex:outputPanel styleClass="grey" layout="block">
                            <apex:pageBlockSection title="{!PlanNameKey}" columns="1" >
                                <apex:pageBlockTable value="{!objectMap [ProgNameKey][PlanNameKey]}" var="lstGrnRate"  border="1" columnsWidth="20%,5%,65%,10%">
                                    
                                                                     
                                    <apex:column value="{!lstGrnRate.Account__r.Name}" headerValue="Customer" />
                                                        
                                  
                                 <apex:column footerClass="reviewStatusHeader" HeaderValue="Status" headerClass="ct">
                                       <apex:image value="{! If(lstGrnRate.Status__c=="Red" ,URLFOR($Resource.RedFlag),
                                                      If(lstGrnRate.Status__c=="Green",URLFOR($Resource.GreenFlag), URLFOR($Resource.AmberFlag))) }" width="60" height="40" />
                                 </apex:column>
           
                                 <apex:column value="{!lstGrnRate.Account_Summary__c}" /> 
                                 <apex:column headerValue="Date of Update" value="{!lstGrnRate.lastModifiedDate}" />   
                                    
                                    
                                </apex:pageBlockTable>
                            </apex:pageBlocksection>
                        </apex:outputPanel>
                    </apex:repeat>
                </apex:pageBlock>
            </apex:repeat>
        </apex:pageBlock>
    </apex:form> 
</apex:page>